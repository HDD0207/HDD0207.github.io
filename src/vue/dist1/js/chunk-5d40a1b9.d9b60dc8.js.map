{"version":3,"sources":["webpack:///./src/views/Search.vue?c428","webpack:///src/views/Search.vue","webpack:///./src/views/Search.vue?0d6a","webpack:///./src/views/Search.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","directives","name","rawName","value","expression","attrs","on","cancel","clearFn","searchFn","model","callback","$$v","$event","stopPropagation","hide","_v","_l","item","index","key","goBook","_s","word","deleteAll","v","j","deleteOne","val","i","getHistory","staticRenderFns","components","loading","data","isLoading","searchData","isShow","searchText","history","created","getData","localStorage","getItem","forEach","computed","methods","$router","go","axios","method","url","addHistory","push","setItem","params","query","text","tipsFn","isHistory","splice","$toast","removeItem","component"],"mappings":"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","file":"js/chunk-5d40a1b9.d9b60dc8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search\"},[_c('loading',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isLoading),expression:\"isLoading\"}]}),_c('form',{attrs:{\"action\":\"/\"}},[_c('van-search',{attrs:{\"show-action\":\"\",\"placeholder\":\"请输入书名或者作者名\"},on:{\"cancel\":_vm.cancel,\"clear\":_vm.clearFn,\"input\":_vm.searchFn},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}})],1),_c('div',{staticClass:\"search-content\",on:{\"click\":function($event){$event.stopPropagation();return _vm.hide($event)}}},[_c('div',{staticClass:\"search-box\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"热门搜索\")]),_c('div',{staticClass:\"search-list\"},_vm._l((_vm.searchData),function(item,index){return _c('span',{key:index,staticClass:\"search-item\",on:{\"click\":function($event){return _vm.goBook(item)}}},[_vm._v(_vm._s(item.word))])}),0)]),_c('div',{staticClass:\"search-box clear\"},[_c('div',{staticClass:\"title fl\"},[_vm._v(\"搜索历史\")]),_c('div',{staticClass:\"delete fr\",on:{\"click\":_vm.deleteAll}},[_vm._v(\"清空\")]),_c('div',{staticClass:\"search-list\"},_vm._l((_vm.history),function(v,j){return _c('span',{key:j,staticClass:\"search-item\"},[_c('span',[_vm._v(_vm._s(v))]),_c('span',{staticClass:\"del-icon\",on:{\"click\":function($event){return _vm.deleteOne(j)}}},[_vm._v(\"x\")])])}),0)]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShow),expression:\"isShow\"}],staticClass:\"search-text\"},_vm._l((_vm.searchText),function(val,i){return _c('div',{key:i,staticClass:\"text\",on:{\"click\":function($event){return _vm.getHistory(val)}}},[_vm._v(_vm._s(val))])}),0)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search\">\r\n    <loading v-show=\"isLoading\" />\r\n    <form action=\"/\">\r\n      <van-search\r\n        v-model=\"value\"\r\n        show-action\r\n        placeholder=\"请输入书名或者作者名\"\r\n        @cancel=\"cancel\"\r\n        @clear=\"clearFn\"\r\n        @input=\"searchFn\"\r\n      />\r\n    </form>\r\n    <div class=\"search-content\" @click.stop=\"hide\">\r\n      <div class=\"search-box\">\r\n        <div class=\"title\">热门搜索</div>\r\n        <div class=\"search-list\">\r\n          <span\r\n            class=\"search-item\"\r\n            v-for=\"(item,index) in searchData\"\r\n            :key=\"index\"\r\n            @click=\"goBook(item)\"\r\n          >{{item.word}}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"search-box clear\">\r\n        <div class=\"title fl\">搜索历史</div>\r\n        <div class=\"delete fr\" @click=\"deleteAll\">清空</div>\r\n        <div class=\"search-list\">\r\n          <span class=\"search-item\" v-for=\"(v,j) in history\" :key=\"j\">\r\n            <span>{{v}}</span>\r\n            <span class=\"del-icon\" @click=\"deleteOne(j)\">x</span>\r\n          </span>\r\n        </div>\r\n      </div>\r\n      <div class=\"search-text\" v-show=\"isShow\">\r\n        <div class=\"text\" v-for=\"(val,i) in searchText\" :key=\"i\" @click=\"getHistory(val)\">{{val}}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport loading from \"../components/loading\";\r\nimport \"../assets/css/search.less\";\r\nimport { createNamespacedHelpers } from \"vuex\";\r\nconst { mapState, mapMutations } = createNamespacedHelpers(\"saveDataFn\");\r\nexport default {\r\n  components: {\r\n    loading\r\n  },\r\n  data() {\r\n    return {\r\n      isLoading: false,\r\n      value: \"\",\r\n      searchData: [],\r\n      isShow: false,\r\n      searchText: [],\r\n      history: []\r\n    };\r\n  },\r\n  created() {\r\n    this.getData();\r\n    if (localStorage.getItem(\"history\")) {\r\n      let history = localStorage.getItem(\"history\").split(\",\");\r\n      history.forEach(v => {\r\n        this.history.push(v);\r\n      });\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState([\"saveHistory\"])\r\n  },\r\n  methods: {\r\n    ...mapMutations([\"addHistory\"]),\r\n    // 点击取消返回\r\n    cancel() {\r\n      this.$router.go(-1);\r\n    },\r\n    // 获取搜索热词\r\n    getData() {\r\n      this.isLoading = true;\r\n      this.axios({\r\n        method: \"get\",\r\n        url: \"http://novel.kele8.cn/hot-books\"\r\n      })\r\n        .then(result => {\r\n          if (result.status == 200) {\r\n            this.searchData = result.data.newHotWords;\r\n            this.isLoading = false;\r\n          }\r\n        })\r\n        .catch(err => {\r\n          this.isLoading = false;\r\n          this.$toast(\"获取搜索热词失败\");\r\n        });\r\n    },\r\n    // 跳转书籍详情\r\n    goBook(item) {\r\n      this.addHistory(item.word);\r\n      this.history.push(item.word)\r\n      localStorage.setItem(\"history\", this.history);\r\n      this.$router.push({ name: \"Book\", query: { id: item.book } });\r\n    },\r\n    // 模糊搜索\r\n    searchFn() {\r\n      if (this.value == \"\") {\r\n        this.isShow = false;\r\n        return;\r\n      }\r\n      this.isShow = true;\r\n      this.axios({\r\n        method: \"get\",\r\n        url: \"http://novel.kele8.cn/auto-complete\",\r\n        params: {\r\n          query: this.value\r\n        }\r\n      })\r\n        .then(result => {\r\n          if (result.status == 200) {\r\n            this.searchText = result.data.keywords;\r\n          }\r\n        })\r\n        .catch(err => {\r\n          this.$toast(\"暂无数据\");\r\n        });\r\n    },\r\n    // 点击清空输入框文字\r\n    clearFn() {\r\n      this.isShow = false;\r\n    },\r\n    // 收起搜索栏\r\n    hide() {\r\n      this.isShow = false;\r\n    },\r\n    // 添加历史搜索\r\n    getHistory(text) {\r\n      this.value = \"\";\r\n      this.history.push(text);\r\n      localStorage.setItem(\"history\", this.history);\r\n      this.tipsFn();\r\n    },\r\n    // 清空所有历史记录\r\n    deleteAll() {\r\n      this.history = [];\r\n      localStorage.setItem(\"history\", this.history);\r\n      this.isHistory();\r\n    },\r\n    // 删除单个搜索历史\r\n    deleteOne(i) {\r\n      this.history.splice(i,1);\r\n      localStorage.setItem(\"history\", this.history);\r\n      this.isHistory();\r\n    },\r\n    // 提示消息\r\n    tipsFn() {\r\n      this.$toast(\"下载追书神器APP体验更多功能\");\r\n    },\r\n    // 判断是否存在搜索历史\r\n    isHistory(){\r\n      if(localStorage.getItem(\"history\").length == 0){\r\n        localStorage.removeItem(\"history\");\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=79810f21&\"\nimport script from \"./Search.vue?vue&type=script&lang=js&\"\nexport * from \"./Search.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}